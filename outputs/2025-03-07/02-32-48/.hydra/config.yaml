teacher:
  comment: ''
  train:
    batch_size: 64
    dl_weight_type: root
    num_data_workers: 0
    wandb: false
    wandb_entity: saffina
    log_freq: 10
    save_model: false
    finetune_from: checkpoints/best_2025-01-08_17_53_03-
    total_train_steps: 1
    test_every: 1
    test_steps: 1
    generate_mae_visualizations: true
    freeze_encoder: true
    freeze_trunk: true
    scheduled_unfreeze: false
    scheduled_unfreeze_step: 20000
    optimizer:
      _target_: torch.optim.AdamW
      lr: 0.0001
      eps: 1.0e-06
      weight_decay: 0.1
    nontrunk_lr_scale: 1.0
    scheduler:
      _target_: torch.optim.lr_scheduler.CosineAnnealingLR
      T_max: ${train.total_train_steps}
      eta_min: 1.0e-08
  network:
    patch_size: 16
    encoder_embed_dim: 768
    encoder_heads: 12
    encoder_depth: 3
    trunk_depth: 9
    mask_ratio: 0.4
    encoders:
      gs_360_v2:
        _target_: t3.models.MAEViTEncoder
        mask_ratio: ${mask_ratio}
        patch_size: ${patch_size}
        embed_dim: ${encoder_embed_dim}
        depth: ${encoder_depth}
        num_heads: ${encoder_heads}
        mlp_ratio: 4.0
      gs_green:
        _target_: t3.models.MAEViTEncoder
        mask_ratio: ${mask_ratio}
        patch_size: ${patch_size}
        embed_dim: ${encoder_embed_dim}
        depth: ${encoder_depth}
        num_heads: ${encoder_heads}
        mlp_ratio: 4.0
      gs_black:
        _target_: t3.models.MAEViTEncoder
        mask_ratio: ${mask_ratio}
        patch_size: ${patch_size}
        embed_dim: ${encoder_embed_dim}
        depth: ${encoder_depth}
        num_heads: ${encoder_heads}
        mlp_ratio: 4.0
      gs_tag:
        _target_: t3.models.MAEViTEncoder
        mask_ratio: ${mask_ratio}
        patch_size: ${patch_size}
        embed_dim: ${encoder_embed_dim}
        depth: ${encoder_depth}
        num_heads: ${encoder_heads}
        mlp_ratio: 4.0
      digit:
        _target_: t3.models.MAEViTEncoder
        mask_ratio: ${mask_ratio}
        patch_size: ${patch_size}
        embed_dim: ${encoder_embed_dim}
        depth: ${encoder_depth}
        num_heads: ${encoder_heads}
        mlp_ratio: 4.0
      mini:
        _target_: t3.models.MAEViTEncoder
        mask_ratio: ${mask_ratio}
        patch_size: ${patch_size}
        embed_dim: ${encoder_embed_dim}
        depth: ${encoder_depth}
        num_heads: ${encoder_heads}
        mlp_ratio: 4.0
      wedge:
        _target_: t3.models.MAEViTEncoder
        mask_ratio: ${mask_ratio}
        patch_size: ${patch_size}
        embed_dim: ${encoder_embed_dim}
        depth: ${encoder_depth}
        num_heads: ${encoder_heads}
        mlp_ratio: 4.0
      finray:
        _target_: t3.models.MAEViTEncoder
        mask_ratio: ${mask_ratio}
        patch_size: ${patch_size}
        embed_dim: ${encoder_embed_dim}
        depth: ${encoder_depth}
        num_heads: ${encoder_heads}
        mlp_ratio: 4.0
    shared_trunk:
      _target_: t3.models.TransformerTrunk
      embed_dim: ${encoder_embed_dim}
      depth: ${trunk_depth}
      num_heads: ${encoder_heads}
      mlp_ratio: 4.0
    decoders:
      mae_recon_single:
        _target_: t3.models.MAEViTDecoder
        patch_size: ${patch_size}
        embed_dim: ${encoder_embed_dim}
        decoder_embed_dim: 512
        decoder_depth: 8
        decoder_num_heads: 16
        mlp_ratio: 4.0
        loss_func:
          _target_: t3.models.MAEReconLoss
          patch_size: 16
          norm_pix_loss: true
student:
  comment: ''
  hydra:
    searchpath:
    - file://../configs
  train:
    batch_size: 64
    dl_weight_type: root
    num_data_workers: 0
    wandb: false
    wandb_entity: saffina
    log_freq: 10
    save_model: false
    finetune_from: ''
    total_train_steps: 1
    test_every: 1
    test_steps: 1
    generate_mae_visualizations: true
    freeze_encoder: false
    freeze_trunk: false
    scheduled_unfreeze: false
    scheduled_unfreeze_step: 20000
    optimizer:
      _target_: torch.optim.AdamW
      lr: 0.0001
      eps: 1.0e-06
      weight_decay: 0.1
    nontrunk_lr_scale: 1.0
    scheduler:
      _target_: torch.optim.lr_scheduler.CosineAnnealingLR
      T_max: ${train.total_train_steps}
      eta_min: 1.0e-08
  network:
    patch_size: 16
    encoder_embed_dim: 768
    encoder_heads: 12
    pooling: none
    encoder_depth: 3
    trunk_depth: 9
    mask_ratio: 0.4
    encoders:
      digit:
        _target_: t3.models.MAEViTEncoder
        mask_ratio: ${mask_ratio}
        patch_size: ${patch_size}
        embed_dim: ${encoder_embed_dim}
        depth: ${encoder_depth}
        num_heads: ${encoder_heads}
        mlp_ratio: 4.0
    shared_trunk:
      _target_: t3.models.TransformerTrunk
      embed_dim: ${encoder_embed_dim}
      depth: ${trunk_depth}
      num_heads: ${encoder_heads}
      mlp_ratio: 4.0
    decoders:
      mae_recon_single:
        _target_: t3.models.MAEViTDecoder
        patch_size: ${patch_size}
        embed_dim: ${encoder_embed_dim}
        decoder_embed_dim: 512
        decoder_depth: 8
        decoder_num_heads: 16
        mlp_ratio: 4.0
        loss_func:
          _target_: t3.models.MAEReconLoss
          patch_size: 16
          norm_pix_loss: true
  datasets:
    VAR_random_resize_crop: true
    VAR_random_hv_flip_prob: 0.5
    VAR_color_jitter:
      brightness: 0.4
      contrast: 0.4
      saturation: 0.5
      hue: 0.3
    tippur23_cylv0:
      activate: true
      eval_only: false
      data_loader:
        _target_: t3.data_loader.SingleTowerMAEDataset
        data_dir: data/FoundationTactile/tippur23_cylv0
        encoder_domain: gs_360_v2
        decoder_domain: mae_recon_single
        random_resize_crop: ${datasets.VAR_random_resize_crop}
        random_hv_flip_prob: ${datasets.VAR_random_hv_flip_prob}
        color_jitter: ${datasets.VAR_color_jitter}
        img_norm:
          mean:
          - 0.48141
          - 0.24831
          - 0.30964
          std:
          - 0.07714
          - 0.07175
          - 0.07466
    tippur23_cylv1:
      activate: true
      eval_only: false
      data_loader:
        _target_: t3.data_loader.SingleTowerMAEDataset
        data_dir: data/FoundationTactile/tippur23_cylv1
        encoder_domain: gs_360_v2
        decoder_domain: mae_recon_single
        random_resize_crop: ${datasets.VAR_random_resize_crop}
        random_hv_flip_prob: ${datasets.VAR_random_hv_flip_prob}
        color_jitter: ${datasets.VAR_color_jitter}
        img_norm:
          mean:
          - 0.26948
          - 0.2395
          - 0.25199
          std:
          - 0.07708
          - 0.07323
          - 0.08599
    tvl:
      activate: true
      eval_only: false
      data_loader:
        _target_: t3.data_loader.SingleTowerMAEDataset
        data_dir: data/FoundationTactile/tvl
        encoder_domain: digit
        decoder_domain: mae_recon_single
        random_resize_crop: ${datasets.VAR_random_resize_crop}
        random_hv_flip_prob: ${datasets.VAR_random_hv_flip_prob}
        color_jitter: ${datasets.VAR_color_jitter}
        img_norm:
          mean:
          - 0.42094
          - 0.44041
          - 0.44151
          std:
          - 0.14661
          - 0.08972
          - 0.09041
    visgel_downsampled:
      activate: true
      eval_only: false
      data_loader:
        _target_: t3.data_loader.SingleTowerMAEDataset
        data_dir: data/FoundationTactile/visgel_downsampled
        encoder_domain: gs_green
        decoder_domain: mae_recon_single
        random_resize_crop: false
        random_hv_flip_prob: 0
        color_jitter: ${datasets.VAR_color_jitter}
        img_norm:
          mean:
          - 0.36917
          - 0.51738
          - 0.51782
          std:
          - 0.1353
          - 0.11039
          - 0.10001
    calandra17:
      activate: true
      eval_only: false
      data_loader:
        _target_: t3.data_loader.SingleTowerMAEDataset
        data_dir: data/FoundationTactile/calandra17
        encoder_domain: gs_green
        decoder_domain: mae_recon_single
        random_resize_crop: ${datasets.VAR_random_resize_crop}
        random_hv_flip_prob: ${datasets.VAR_random_hv_flip_prob}
        color_jitter: ${datasets.VAR_color_jitter}
        img_norm:
          mean:
          - 0.27307
          - 0.27307
          - 0.27307
          std:
          - 0.26252
          - 0.28064
          - 0.3076
    touch_and_go:
      activate: true
      eval_only: false
      data_loader:
        _target_: t3.data_loader.SingleTowerMAEDataset
        data_dir: data/FoundationTactile/touch_and_go
        encoder_domain: gs_tag
        decoder_domain: mae_recon_single
        random_resize_crop: ${datasets.VAR_random_resize_crop}
        random_hv_flip_prob: ${datasets.VAR_random_hv_flip_prob}
        color_jitter: ${datasets.VAR_color_jitter}
        img_norm:
          mean:
          - 0.51808
          - 0.503
          - 0.51457
          std:
          - 0.13893
          - 0.11343
          - 0.13497
    yuan_18:
      activate: true
      eval_only: false
      data_loader:
        _target_: t3.data_loader.SingleTowerMAEDataset
        data_dir: data/FoundationTactile/yuan18
        encoder_domain: gs_green
        decoder_domain: mae_recon_single
        random_resize_crop: ${datasets.VAR_random_resize_crop}
        random_hv_flip_prob: ${datasets.VAR_random_hv_flip_prob}
        color_jitter: ${datasets.VAR_color_jitter}
        img_norm:
          mean:
          - 0.41745
          - 0.42082
          - 0.40049
          std:
          - 0.11456
          - 0.11639
          - 0.10868
    ycbsight_real:
      activate: true
      eval_only: true
      data_loader:
        _target_: t3.data_loader.SingleTowerMAEDataset
        data_dir: data/FoundationTactile/ycbsight_real
        encoder_domain: gs_green
        decoder_domain: mae_recon_single
        random_resize_crop: ${datasets.VAR_random_resize_crop}
        random_hv_flip_prob: ${datasets.VAR_random_hv_flip_prob}
        color_jitter: null
        img_norm:
          mean:
          - 0.5104
          - 0.51558
          - 0.57299
          std:
          - 0.06538
          - 0.09097
          - 0.12421
    ycbsight_sim:
      activate: true
      eval_only: false
      data_loader:
        _target_: t3.data_loader.SingleTowerMAEDataset
        data_dir: data/FoundationTactile/ycbsight_sim
        encoder_domain: gs_green
        decoder_domain: mae_recon_single
        random_resize_crop: ${datasets.VAR_random_resize_crop}
        random_hv_flip_prob: ${datasets.VAR_random_hv_flip_prob}
        color_jitter: ${datasets.VAR_color_jitter}
        img_norm:
          mean:
          - 0.52429
          - 0.51465
          - 0.60872
          std:
          - 0.06524
          - 0.08824
          - 0.11888
    objectfolder_real:
      activate: true
      eval_only: false
      data_loader:
        _target_: t3.data_loader.SingleTowerMAEDataset
        data_dir: data/FoundationTactile/objectfolder_real
        encoder_domain: gs_black
        decoder_domain: mae_recon_single
        random_resize_crop: ${datasets.VAR_random_resize_crop}
        random_hv_flip_prob: ${datasets.VAR_random_hv_flip_prob}
        color_jitter: ${datasets.VAR_color_jitter}
        img_norm:
          mean:
          - 0.46676
          - 0.45028
          - 0.45292
          std:
          - 0.08171
          - 0.06973
          - 0.08618
